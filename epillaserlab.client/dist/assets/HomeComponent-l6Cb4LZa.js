import{d as T,u as k,b as F,r as f,_ as $,g,o as I,c as N,e as _,h as a,p as s,F as j,x as c,t as p}from"./index-BabCA39_.js";import{I as w,O as L,D as O}from"./style-CAl2ip43.js";const V=T({components:{TableBody:w,TableHead:L,DataTable:O},setup(){const o=k();F();const m=f([]),l=f({}),u=f({}),h=n=>n.target.parentNode.dataset.id;return{tableData:m,pagination:l,loadData:async n=>{let t,i,e,d;e=u.value.sort,typeof n=="string"?(t=l.value.page,i=l.value.limit,e=e=="asc"?"desc":"asc",d=n.split(":")[0],d!==u.value.order&&(e="desc")):typeof n==typeof{}?(t=n.page-1<0?0:n.page-1,i=n.per_page,d=u.value.order):(t=l.value.page,i=l.value.limit,d=u.value.order);let y={page:t,limit:i,sort:e,order:d};var S=new URLSearchParams(y);await fetch(`/api/applications?${S}`,{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async v=>{let C=await v.json();if(C.message="OK"){let b=C.data,x=b.max;t=b.page;let B=b.recs;m.value=B,l.value={...l.value,page:t,total:x,limit:i},u.value={...u.value,sort:e,order:d}}else m.value=[],l.value={...l.value,page:0,total:0,limit:i},u.value={...u.value,sort:e,order:d}}).catch(v=>o.push({name:"dashboard"}))},sort:u,editClick:async n=>{let t=h(n);await o.push({name:"dashboard.applications.edit",params:{id:t}})}}}}),E=_("h1",{class:"h2"}," Главная ",-1),H=_("TableBodyCell",{class:"d-flex justify-content-center",colspan:"2"}," Нет записей ",-1);function R(o,m,l,u,h,D){const r=g("table-head"),n=g("router-link"),t=g("table-body"),i=g("data-table");return I(),N(j,null,[E,_("div",null,[a(i,{rows:o.tableData,pagination:o.pagination,sort:o.sort,striped:"",onLoadData:o.loadData,style:{"font-size":"large !important"}},{thead:s(()=>[a(r,{sortable:"branch",onSorting:o.loadData},{default:s(()=>[c("Филлиал")]),_:1},8,["onSorting"]),a(r,{sortable:"master",onSorting:o.loadData},{default:s(()=>[c("Мастер")]),_:1},8,["onSorting"]),a(r,{sortable:"client",onSorting:o.loadData},{default:s(()=>[c("Клиент")]),_:1},8,["onSorting"]),a(r,{sortable:"dateTime",onSorting:o.loadData},{default:s(()=>[c("Дата и время")]),_:1},8,["onSorting"]),a(r,{sortable:"service",onSorting:o.loadData},{default:s(()=>[c("Услуга")]),_:1},8,["onSorting"]),a(r,{sortable:"price",onSorting:o.loadData},{default:s(()=>[c("Цена")]),_:1},8,["onSorting"]),a(r,{style:{width:"7%"}},{default:s(()=>[a(n,{to:{name:"dashboard.applications.add"},tag:"button",type:"button",class:"btn btn-success"},{default:s(()=>[c("Добавить")]),_:1})]),_:1})]),tbody:s(({row:e})=>[a(t,{textContent:p(e.branch)},null,8,["textContent"]),a(t,{textContent:p(e.master)},null,8,["textContent"]),a(t,{textContent:p(e.client)},null,8,["textContent"]),a(t,{textContent:p(e.dateTime)},null,8,["textContent"]),a(t,{textContent:p(e.service)},null,8,["textContent"]),a(t,{textContent:p(e.price)},null,8,["textContent"]),a(t,{"data-id":e.applicationId,style:{width:"7%"}},null,8,["data-id"])]),empty:s(()=>[H]),_:1},8,["rows","pagination","sort","onLoadData"])])],64)}const J=$(V,[["render",R]]);export{J as default};
