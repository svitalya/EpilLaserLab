import{d as c,u as m,b as p,a as h,_ as f,g as b,o as g,c as _,e as s,w as v,v as w,h as y,p as D,m as T,y as C}from"./index-DnMKBQom.js";import{D as B,I as O,O as x}from"./style-ko_XgC6k.js";const A=c({components:{DataTable:B,TableBody:O,TableHead:x},setup(){const o=m(),t=p(),u=h({address:null,photoFile:null});return{data:u,submitForm:async n=>{await fetch("/api/branches",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)}).then(async a=>{const e=await a.json();e.message=="OK"?(t.success("Запись успешно добавлена"),o.push({name:"dashboard.branches"})):e.message=="DUPLICATION"||e.message=="DUPLICATION"?t.error("Дублирование записи"):e.message=="NOT CHANGED"?t.info("Внесите изменения"):e.message=="DATA NOT VALID"||e.status==400?t.error("Введите значения"):t.error("Ошибка при добавлении записи")}).catch(a=>o.push({name:"dashboard"}))},getBase64:n=>{let a=n.files[0];var e=new FileReader;e.readAsDataURL(a),e.onload=function(){let r=e.result.split(";"),d=r[0];["data:image/jpeg","data:image/png","data:image/jpg"].indexOf(d)!=-1?(u.photoFile=r[1].replace("base64,",""),document.getElementById("image").src=e.result):(n.value=null,t.error("Недопустимый тип файла"))},e.onerror=function(r){console.log("Error: ",r)}}}}}),N=s("div",{class:"flex-column"},[s("h1",{class:"row h3"}," Добавить запись филиала ")],-1),F={class:"col-3"},I={class:"row form-group mt-3"},E=s("img",{width:"300px",height:"300px",src:"https://imgholder.ru/300X300/8493a8/adb9ca&font=kelson",id:"image"},null,-1),k=s("label",{class:"h5"},"Изображение",-1),V={class:"input-group mb-3"},j=s("label",{class:"input-group-text"},"Загрузка",-1),L={class:"row form-group mt-3"},U=s("label",{class:"h5"},"Адрес",-1),$={class:"col-12"},P={class:"row mt-4"},R=s("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function S(o,t,u,l,i,n){const a=b("router-link");return g(),_("div",null,[N,s("form",{onSubmit:t[2]||(t[2]=T((...e)=>o.submitForm&&o.submitForm(...e),["prevent"])),class:"row mt-3"},[s("div",F,[s("div",I,[E,k,s("div",V,[s("input",{type:"file",class:"form-control",onChange:t[0]||(t[0]=e=>{e.target.files.length>0&&o.getBase64(e.target)})},null,32),j])]),s("div",L,[U,s("div",$,[v(s("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.data.address=e),class:"form-control",placeholder:"Введите адрес"},null,512),[[w,o.data.address]])])]),s("div",P,[R,y(a,{tag:"button",to:{name:"dashboard.branches"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:D(()=>[C("Назад")]),_:1})])])],32)])}const G=f(A,[["render",S]]);export{G as default};
