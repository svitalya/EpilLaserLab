import{d as f,u as v,b as D,a as C,r as T,_ as w,g as d,o as g,c as B,e,w as p,v as m,h as n,p as l,m as F,x as h,t as N}from"./index-BabCA39_.js";import{D as O,I as E,O as A}from"./style-CAl2ip43.js";const V=f({components:{DataTable:O,TableBody:E,TableHead:A},setup(){const u=v(),s=D(),r=C({name:"",description:"",timeCost:0,priceByType:[]}),i=T([]);return{data:r,submitForm:async c=>{r.priceByType=[],document.querySelectorAll("input#service_price_val").forEach(a=>{let t=a;console.log(t),t.value&&r.priceByType.push({key:t.dataset.typeId,value:Number(t.value)})}),await fetch("/api/services",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}).then(async a=>{const t=await a.json();t.message=="OK"?(s.success("Запись успешно добавлена"),u.push({name:"dashboard.services"})):t.message=="DUPLICATION"?s.error("Дублирование записи"):t.message=="NOT CHANGED"?s.info("Внесите изменения"):t.message=="DATA NOT VALID"||t.status==400?s.error("Введите значения"):s.error("Ошибка при добавлении записи")}).catch(a=>u.push({name:"dashboard"}))},tableData:i,loadData:async c=>{await fetch("/api/types",{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async a=>{let t=await a.json();t.message=="OK"?i.value=t.data.recs:s.error("Ошибка")}).catch(a=>u.push({name:"dashboard"}))}}}}),x=e("div",{class:"flex-column"},[e("h1",{class:"row h3"}," Добавить запись услуги ")],-1),I={class:"col-3"},j={class:"row form-group mt-3"},k=e("label",{class:"h5"},"Название",-1),S={class:"col-12"},L={class:"row form-group mt-3"},U=e("label",{class:"h5"},"Описание",-1),$={class:"col-12"},q={class:"row form-group mt-3"},H=e("label",{class:"h5"},"Время выполнения",-1),J={class:"col-12"},K={class:"row mt-4"},M=e("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1),P={class:"col-9"},z=["data-type-id"],G=e("TableBodyCell",{class:"d-flex justify-content-center",colspan:"2"}," Нет записей ",-1);function R(u,s,r,i,_,b){const c=d("router-link"),a=d("table-head"),t=d("table-body"),y=d("data-table");return g(),B("div",null,[x,e("form",{onSubmit:s[3]||(s[3]=F((...o)=>u.submitForm&&u.submitForm(...o),["prevent"])),class:"row mt-3"},[e("div",I,[e("div",j,[k,e("div",S,[p(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>u.data.name=o),class:"form-control",placeholder:"Введите название"},null,512),[[m,u.data.name]])])]),e("div",L,[U,e("div",$,[p(e("textarea",{type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>u.data.description=o),class:"form-control",placeholder:"Введите описание"},null,512),[[m,u.data.description]])])]),e("div",q,[H,e("div",J,[p(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=o=>u.data.timeCost=o),class:"form-control",placeholder:"Введите врем"},null,512),[[m,u.data.timeCost]])])]),e("div",K,[M,n(c,{tag:"button",to:{name:"dashboard.services"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:l(()=>[h("Назад")]),_:1})])]),e("div",P,[n(y,{rows:u.tableData,striped:"",id:"pricesTable",onLoadData:u.loadData,style:{"font-size":"large !important"}},{thead:l(()=>[n(a,null,{default:l(()=>[h("Вид прайслиста")]),_:1}),n(a,null,{default:l(()=>[h("Цена")]),_:1}),n(a)]),tbody:l(({row:o})=>[n(t,{textContent:N(o.name)},null,8,["textContent"]),n(t,null,{default:l(()=>[e("input",{class:"form-control",id:"service_price_val","data-type-id":o.id,type:"number"},null,8,z)]),_:2},1024),n(t)]),empty:l(()=>[G]),_:1},8,["rows","onLoadData"])])],32)])}const X=w(V,[["render",R]]);export{X as default};
