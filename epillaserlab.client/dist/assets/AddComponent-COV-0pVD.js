import{d as h,u as f,b,a as c,r as _,_ as v,g as w,o as n,c as d,e,w as m,v as y,z as D,F as I,j as C,h as T,p as g,m as O,t as N,y as F}from"./index-DnMKBQom.js";import{D as S,I as A,O as U}from"./style-ko_XgC6k.js";import{U as V}from"./UserStore-DUfprOyA.js";const $=h({components:{DataTable:S,TableBody:A,TableHead:U},async beforeCreate(){var t=await V.user(),s=null;t.roleId==2&&(s=t.admin.branchId),await fetch(`/api/masters?limit=9999&branchId=${s}`,{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async r=>{let o=await r.json();o.message=="OK"&&(this.masters=o.data.recs,this.data.masterId=o.data.recs[0].masterId)}),this.$forceUpdate()},setup(){const t=f(),s=b(),r=c([{masterId:0,fio:""}]),o=c({date:new Date().toJSON().slice(0,10),masterId:null}),i=_([]);return{data:o,submitForm:async l=>{await fetch("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)}).then(async a=>{const u=await a.json();u.message=="OK"?(s.success("Запись успешно добавлена"),t.push({name:"dashboard.schedules"})):u.message=="DUPLICATION"?s.error("Дублирование записи"):u.message=="NOT CHANGED"?s.info("Внесите изменения"):u.message=="DATA NOT VALID"||u.status==400?s.error("Введите значения"):s.error("Ошибка при добавлении записи")}).catch(a=>t.push({name:"dashboard"}))},tableData:i,masters:r}}}),j=e("div",{class:"flex-column"},[e("h1",{class:"row h3"}," Добавить запись расписания ")],-1),k={class:"col-3"},B={class:"row form-group mt-3"},E=e("label",{class:"h5"},"Дата",-1),J={class:"col-12"},L=["min"],M={class:"row form-group mt-3"},x=e("label",{class:"h5"},"Мастер",-1),H={class:"col-12"},K=["value"],P={class:"row mt-4"},z=e("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function G(t,s,r,o,i,p){const l=w("router-link");return n(),d("div",null,[j,e("form",{onSubmit:s[2]||(s[2]=O((...a)=>t.submitForm&&t.submitForm(...a),["prevent"])),class:"row mt-3"},[e("div",k,[e("div",B,[E,e("div",J,[m(e("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=a=>t.data.date=a),class:"form-control",placeholder:"Введите название",min:new Date().toJSON().slice(0,10)},null,8,L),[[y,t.data.date]])])]),e("div",M,[x,e("div",H,[m(e("select",{class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>t.data.masterId=a)},[(n(!0),d(I,null,C(t.masters,a=>(n(),d("option",{value:a.masterId},N(a.fio),9,K))),256))],512),[[D,t.data.masterId]])])]),e("div",P,[z,T(l,{tag:"button",to:{name:"dashboard.schedules"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:g(()=>[F("Назад")]),_:1})])])],32)])}const W=v($,[["render",G]]);export{W as default};
