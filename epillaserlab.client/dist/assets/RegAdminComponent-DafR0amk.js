import{u as m,b as p,_ as h,o as a,c as l,e,m as f,w as u,z as _,F as b,j as g,v as i,t as y}from"./index-DnMKBQom.js";const v={data(){return{branches:[],branchId:null,surname:"",name:"",patronymic:"",login:"",password:""}},mounted(){this.loadBranches()},setup(){const n=m(),s=p();return{router:n,toast:s}},methods:{loadBranches(){fetch("/api/branches?limit=9999").then(s=>s.json()).then(s=>{this.branches=s.data.recs,this.branchId=s.data.recs[0].branchId}).catch(s=>console.error(s))},async register(){const n="/api/auth/register/admins",s={branchId:this.branchId,surname:this.surname,name:this.name,patronymic:this.patronymic,login:this.login,password:this.password},r=await(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)})).json();r.message=="OK"?(this.toast.success("Запись успешно добавлена"),this.router.push({name:"dashboard.users",params:{role:"admin"}})):r.message=="DUPLICATION"?this.toast.error("Дублирование записи"):r.message=="NOT CHANGED"?this.toast.info("Внесите изменения"):r.message=="DATA NOT VALID"||r.status==400?this.toast.error("Введите значения"):this.toast.error("Ошибка при добавлении записи")}}},w={class:"container"},I={class:"row justify-content-center"},B={class:"col-md-6"},U={class:"card"},C=e("div",{class:"card-header"},"Регистрация администратора",-1),x={class:"card-body"},D={class:"form-group"},E=e("label",{for:"branchId"},"Филиал:",-1),T=["value"],V={class:"form-group mt-3"},A=e("label",{for:"surname"},"Фамилия:",-1),F={class:"form-group mt-3"},N=e("label",{for:"name"},"Имя:",-1),O={class:"form-group mt-3"},j=e("label",{for:"patronymic"},"Отчество:",-1),q={class:"form-group mt-3"},S=e("label",{for:"login"},"Логин:",-1),k={class:"form-group mt-3"},L=e("label",{for:"password"},"Пароль:",-1),M=e("button",{type:"submit",class:"btn btn-success mt-3"},"Зарегистрировать",-1);function P(n,s,c,r,o,d){return a(),l("div",w,[e("div",I,[e("div",B,[e("div",U,[C,e("div",x,[e("form",{onSubmit:s[6]||(s[6]=f((...t)=>d.register&&d.register(...t),["prevent"]))},[e("div",D,[E,u(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.branchId=t),class:"form-control",required:""},[(a(!0),l(b,null,g(o.branches,t=>(a(),l("option",{key:t.branchId,value:t.branchId},y(t.address),9,T))),128))],512),[[_,o.branchId]])]),e("div",V,[A,u(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=t=>o.surname=t),class:"form-control",required:""},null,512),[[i,o.surname]])]),e("div",F,[N,u(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>o.name=t),class:"form-control",required:""},null,512),[[i,o.name]])]),e("div",O,[j,u(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>o.patronymic=t),class:"form-control"},null,512),[[i,o.patronymic]])]),e("div",q,[S,u(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=t=>o.login=t),class:"form-control",required:""},null,512),[[i,o.login]])]),e("div",k,[L,u(e("input",{type:"password","onUpdate:modelValue":s[5]||(s[5]=t=>o.password=t),class:"form-control",required:""},null,512),[[i,o.password]])]),M],32)])])])])])}const z=h(v,[["render",P]]);export{z as default};
