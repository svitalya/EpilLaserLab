import{d as g,s as y,u as _,i as p,_ as v,e as w,o as i,c as d,a as e,w as l,y as C,F as D,h as k,v as c,z as I,f as T,m as B,l as E,t as O,x as A}from"./index-tN0-wq2L.js";import{D as F,I as N,O as U}from"./style--A4TkPIt.js";const V=g({components:{DataTable:F,TableBody:N,TableHead:U},beforeCreate(){fetch("/api/branches?page=0&limit=999&order=name&sort=asc",{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async o=>{let s=await o.json();s.message=="OK"&&(this.branches=s.data.recs,this.data.branchId=this.branches[0].branchId,this.$forceUpdate())})},setup(){const o=y(),s=_(),m=p([{branchId:0,address:""}]),n=p({branchId:0,employee:{surname:null,name:null,patronymic:null,isWork:!0},photo:null});return{data:n,submitForm:async u=>{await fetch("/api/masters",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)}).then(async t=>{const a=await t.json();a.message=="OK"?(s.success("Запись успешно добавлена"),o.push({name:"dashboard.masters"})):a.message=="DUPLICATION"||a.message=="DUPLICATION"?s.error("Дублирование записи"):a.message=="NOT CHANGED"?s.info("Внесите изменения"):a.message=="DATA NOT VALID"||a.status==400?s.error("Введите значения"):s.error("Ошибка при добавлении записи")}).catch(t=>o.push({name:"dashboard"}))},getBase64:u=>{let t=u.files[0];var a=new FileReader;a.readAsDataURL(t),a.onload=function(){let r=a.result.split(";"),b=r[0];["data:image/jpeg","data:image/png","data:image/jpg"].indexOf(b)!=-1?(n.photo=r[1].replace("base64,",""),document.getElementById("image").src=a.result):(u.value=null,s.error("Недопустимый тип файла"))},a.onerror=function(r){console.log("Error: ",r)}},branches:m}}}),x=e("div",{class:"flex-column"},[e("h1",{class:"row h3"}," Добавить запись сотрудника ")],-1),j={class:"col-3"},L={class:"row form-group mt-3"},S=e("img",{width:"300px",height:"300px",src:"https://imgholder.ru/300X300/8493a8/adb9ca&font=kelson",id:"image"},null,-1),$=e("label",{class:"h5"},"Изображение",-1),M={class:"input-group mb-3"},P=e("label",{class:"input-group-text"},"Загрузка",-1),R={class:"row form-group mt-3"},W=e("label",{class:"h5"},"Филиал",-1),H={class:"col-12"},J=["value"],K={class:"row form-group mt-3"},z=e("label",{class:"h5"},"Фамилия",-1),G={class:"col-12"},X={class:"row form-group mt-3"},q=e("label",{class:"h5"},"Имя",-1),Q={class:"col-12"},Y={class:"row form-group mt-3"},Z=e("label",{class:"h5"},"Отчество",-1),ee={class:"col-12"},se={class:"form-check mt-3"},te=e("label",{class:"form-check-label h5",for:"flexCheckDefault"}," Работает ",-1),oe={class:"row mt-4"},ae=e("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function ue(o,s,m,n,h,f){const u=w("router-link");return i(),d("div",null,[x,e("form",{onSubmit:s[6]||(s[6]=E((...t)=>o.submitForm&&o.submitForm(...t),["prevent"])),class:"row mt-3"},[e("div",j,[e("div",L,[S,$,e("div",M,[e("input",{type:"file",class:"form-control",onChange:s[0]||(s[0]=t=>{t.target.files.length>0&&o.getBase64(t.target)})},null,32),P])]),e("div",R,[W,e("div",H,[l(e("select",{class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>o.data.branchId=t)},[(i(!0),d(D,null,k(o.branches,t=>(i(),d("option",{value:t.branchId},O(t.address),9,J))),256))],512),[[C,o.data.branchId]])])]),e("div",K,[z,e("div",G,[l(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>o.data.employee.surname=t),class:"form-control",placeholder:"Введите адрес"},null,512),[[c,o.data.employee.surname]])])]),e("div",X,[q,e("div",Q,[l(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>o.data.employee.name=t),class:"form-control",placeholder:"Введите адрес"},null,512),[[c,o.data.employee.name]])])]),e("div",Y,[Z,e("div",ee,[l(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=t=>o.data.employee.patronymic=t),class:"form-control",placeholder:"Введите адрес"},null,512),[[c,o.data.employee.patronymic]])])]),e("div",se,[te,l(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=t=>o.data.employee.isWork=t),id:"flexCheckDefault"},null,512),[[I,o.data.employee.isWork]])]),e("div",oe,[ae,T(u,{tag:"button",to:{name:"dashboard.masters"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:B(()=>[A("Назад")]),_:1})])])],32)])}const re=v(V,[["render",ue]]);export{re as default};
