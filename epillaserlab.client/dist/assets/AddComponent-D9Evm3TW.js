import{d as h,s as f,u as b,i as c,r as _,_ as v,e as w,o as n,c as r,a as e,w as m,v as y,y as D,F as C,h as T,f as I,m as g,l as O,t as N,x as F}from"./index-tN0-wq2L.js";import{D as S,I as A,O as V}from"./style--A4TkPIt.js";const $=h({components:{DataTable:S,TableBody:A,TableHead:V},async beforeCreate(){await fetch("/api/masters?limit=9999",{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async t=>{let s=await t.json();s.message=="OK"&&(this.masters=s.data.recs,this.data.masterId=s.data.recs[0].masterId)}),this.$forceUpdate()},setup(){const t=f(),s=b(),i=c([{masterId:0,fio:""}]),u=c({date:new Date().toJSON().slice(0,10),masterId:null}),d=_([]);return{data:u,submitForm:async l=>{await fetch("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)}).then(async a=>{const o=await a.json();o.message=="OK"?(s.success("Запись успешно добавлена"),t.push({name:"dashboard.schedules"})):o.message=="DUPLICATION"?s.error("Дублирование записи"):o.message=="NOT CHANGED"?s.info("Внесите изменения"):o.message=="DATA NOT VALID"||o.status==400?s.error("Введите значения"):s.error("Ошибка при добавлении записи")}).catch(a=>t.push({name:"dashboard"}))},tableData:d,masters:i}}}),j=e("div",{class:"flex-column"},[e("h1",{class:"row h3"}," Добавить запись расписания ")],-1),k={class:"col-3"},B={class:"row form-group mt-3"},E=e("label",{class:"h5"},"Дата",-1),J={class:"col-12"},U=["min"],x={class:"row form-group mt-3"},L=e("label",{class:"h5"},"Мастер",-1),M={class:"col-12"},H=["value"],K={class:"row mt-4"},P=e("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function G(t,s,i,u,d,p){const l=w("router-link");return n(),r("div",null,[j,e("form",{onSubmit:s[2]||(s[2]=O((...a)=>t.submitForm&&t.submitForm(...a),["prevent"])),class:"row mt-3"},[e("div",k,[e("div",B,[E,e("div",J,[m(e("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=a=>t.data.date=a),class:"form-control",placeholder:"Введите название",min:new Date().toJSON().slice(0,10)},null,8,U),[[y,t.data.date]])])]),e("div",x,[L,e("div",M,[m(e("select",{class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>t.data.masterId=a)},[(n(!0),r(C,null,T(t.masters,a=>(n(),r("option",{value:a.masterId},N(a.fio),9,H))),256))],512),[[D,t.data.masterId]])])]),e("div",K,[P,I(l,{tag:"button",to:{name:"dashboard.schedules"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:g(()=>[F("Назад")]),_:1})])])],32)])}const z=v($,[["render",G]]);export{z as default};
