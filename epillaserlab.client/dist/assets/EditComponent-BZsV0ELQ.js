import{d as v,u as f,b,a as m,_ as y,g as _,o as r,c as l,e as s,w as i,z as D,F as w,j as g,v as d,h as C,p as T,m as I,t as E,y as F}from"./index-1Nx-P1XQ.js";import{D as O,I as k,O as N}from"./style-DmTOC_lk.js";const V=v({components:{DataTable:O,TableBody:k,TableHead:N},async beforeCreate(){await fetch("/api/services?page=0&limit=999&order=name&sort=asc",{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async e=>{let t=await e.json();t.message=="OK"&&(this.serviceData=t.data.recs)}),await fetch(`/api/seasontickets/${this.id}`,{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async e=>{let t=await e.json();if(t.message=="OK"){let o=t.rec;this.data.serviceId=o.serviceId,this.data.sessions=o.sessions,this.data.validityPeriod=o.validityPeriod,this.data.price=o.price}}),this.$forceUpdate()},setup(){const e=f(),t=e.currentRoute.value.params.id,o=b(),n=m({serviceId:null,sessions:null,validityPeriod:null,price:null});let c=m([{serviceId:0,name:""}]);return{data:n,submitForm:async p=>{await fetch(`/api/seasontickets/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)}).then(async u=>{const a=await u.json();a.message=="OK"?(o.success("Запись успешно добавлена"),e.push({name:"dashboard.seasontickets"})):a.message=="DUPLICATION"?o.error("Дублирование записи"):a.message=="NOT CHANGED"?o.info("Внесите изменения"):a.message=="DATA NOT VALID"||a.status==400?o.error("Введите значения"):o.error("Ошибка при изменении записи")}).catch(u=>e.push({name:"dashboard"}))},serviceData:c,id:t}}}),j=s("div",{class:"flex-column"},[s("h1",{class:"row h3"}," Изменить запись абонемента ")],-1),A={class:"col-3"},B={class:"row form-group mt-3"},P=s("label",{class:"h5"},"Услуга",-1),U={class:"col-12"},$=["value"],S={class:"row form-group mt-3"},J=s("label",{class:"h5"},"Посещений",-1),K={class:"col-12"},L={class:"row form-group mt-3"},M=s("label",{class:"h5"},"Дней действует",-1),H={class:"col-12"},R={class:"row form-group mt-3"},z=s("label",{class:"h5"},"Цена",-1),G={class:"col-12"},q={class:"row mt-4"},Q=s("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function W(e,t,o,n,c,h){const p=_("router-link");return r(),l("div",null,[j,s("form",{onSubmit:t[4]||(t[4]=I((...u)=>e.submitForm&&e.submitForm(...u),["prevent"])),class:"row mt-3"},[s("div",A,[s("div",B,[P,s("div",U,[i(s("select",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=u=>e.data.serviceId=u)},[(r(!0),l(w,null,g(e.serviceData,u=>(r(),l("option",{value:u.serviceId},E(u.name),9,$))),256))],512),[[D,e.data.serviceId]])])]),s("div",S,[J,s("div",K,[i(s("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=u=>e.data.sessions=u),class:"form-control",placeholder:"Введите количество посещений"},null,512),[[d,e.data.sessions]])])]),s("div",L,[M,s("div",H,[i(s("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=u=>e.data.validityPeriod=u),class:"form-control",placeholder:"Введите количество дней"},null,512),[[d,e.data.validityPeriod]])])]),s("div",R,[z,s("div",G,[i(s("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=u=>e.data.price=u),class:"form-control",placeholder:"Введите цену"},null,512),[[d,e.data.price]])])]),s("div",q,[Q,C(p,{tag:"button",to:{name:"dashboard.seasontickets"},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:T(()=>[F("Назад")]),_:1})])])],32)])}const Z=y(V,[["render",W]]);export{Z as default};
