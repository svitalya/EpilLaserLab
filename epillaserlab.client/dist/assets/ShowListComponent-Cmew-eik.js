import{_ as T,d as x,g as u,o as m,c as $,h as d,p as r,u as j,B as L,r as g,C as N,x as f,k as h,f as C,t as D,e as V}from"./index-BabCA39_.js";import{D as O,O as R,I as E}from"./style-CAl2ip43.js";const I=x({components:{DataTable:O,TableHead:R,TableBody:E},setup(){j();const e=L(),p=g(e.params.role??null);N(()=>e.params.role,a=>{p.value=a??!1,b()});const c=g([]),t=g({}),l=g({}),b=async a=>{let s,o,i,n;typeof a=="string"?(s=t.value.page,o=t.value.limit,i=l.value.sort==="asc"?"desc":"asc",n=a.split(":")[0]):typeof a=="object"?(s=a.page-1<0?0:a.page-1,o=a.per_page,n=l.value.order):(s=t.value.page,o=t.value.limit,n=l.value.order);let y={page:s,limit:o,sort:i,order:n};p.value&&(y.role=p.value);var S=new URLSearchParams(y);await fetch(`/api/auth/users?${S}`,{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async v=>{let k=await v.json();if(k.message==="OK"){let _=k.data,B=_.max;s=_.page;let w=_.recs;c.value=w,t.value={...t.value,page:s,total:B,limit:o},l.value={...l.value,sort:i,order:n}}else c.value=[],t.value={...t.value,page:0,total:0,limit:o},l.value={...l.value,sort:i,order:n}}).catch(v=>console.error(v))};return{tableData:c,pagination:t,sort:l,loadData:b,role:p}}}),H=V("TableBodyCell",{class:"d-flex justify-content-center",colspan:"2"}," Нет записей ",-1);function J(e,p,c,t,l,b){const a=u("table-head"),s=u("router-link"),o=u("table-body"),i=u("data-table");return m(),$("div",null,[d(i,{rows:e.tableData,pagination:e.pagination,sort:e.sort,striped:"",onLoadData:e.loadData},{thead:r(()=>[d(a,{sortable:"login",onSorting:e.loadData},{default:r(()=>[f("Логин")]),_:1},8,["onSorting"]),d(a,{sortable:"email",onSorting:e.loadData},{default:r(()=>[f("Email")]),_:1},8,["onSorting"]),e.role?C("",!0):(m(),h(a,{key:0,sortable:"role",onSorting:e.loadData},{default:r(()=>[f("Роль")]),_:1},8,["onSorting"])),e.role=="admin"?(m(),h(a,{key:1},{default:r(()=>[d(s,{to:{name:"dashboard.users.admins.reg"},tag:"button",type:"button",class:"btn btn-success"},{default:r(()=>[f("Добавить")]),_:1})]),_:1})):C("",!0)]),tbody:r(({row:n})=>[d(o,{textContent:D(n.login)},null,8,["textContent"]),d(o,{textContent:D(n.email)},null,8,["textContent"]),e.role?C("",!0):(m(),h(o,{key:0,textContent:D(n.role)},null,8,["textContent"]))]),empty:r(()=>[H]),_:1},8,["rows","pagination","sort","onLoadData"])])}const U=T(I,[["render",J]]);export{U as default};
