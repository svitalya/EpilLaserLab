import{_ as T,d as j,e as u,o as m,c as x,f as d,m as r,s as $,B as L,r as g,C as N,x as b,j as h,b as C,t as D,a as V}from"./index-tN0-wq2L.js";import{D as O,O as R,I as E}from"./style--A4TkPIt.js";const I=j({components:{DataTable:O,TableHead:R,TableBody:E},setup(){$();const e=L(),c=g(e.params.role??null);N(()=>e.params.role,a=>{c.value=a??!1,f()});const p=g([]),t=g({}),l=g({}),f=async a=>{let s,o,i,n;typeof a=="string"?(s=t.value.page,o=t.value.limit,i=l.value.sort==="asc"?"desc":"asc",n=a.split(":")[0]):typeof a=="object"?(s=a.page-1<0?0:a.page-1,o=a.per_page,n=l.value.order):(s=t.value.page,o=t.value.limit,n=l.value.order);let y={page:s,limit:o,sort:i,order:n};c.value&&(y.role=c.value);var k=new URLSearchParams(y);await fetch(`/api/auth/users?${k}`,{headers:{"Content-Type":"application/json"},credentials:"include"}).then(async v=>{let S=await v.json();if(S.message==="OK"){let _=S.data,B=_.max;s=_.page;let w=_.recs;p.value=w,t.value={...t.value,page:s,total:B,limit:o},l.value={...l.value,sort:i,order:n}}else p.value=[],t.value={...t.value,page:0,total:0,limit:o},l.value={...l.value,sort:i,order:n}}).catch(v=>console.error(v))};return{tableData:p,pagination:t,sort:l,loadData:f,role:c}}}),H=V("TableBodyCell",{class:"d-flex justify-content-center",colspan:"2"}," Нет записей ",-1);function J(e,c,p,t,l,f){const a=u("table-head"),s=u("router-link"),o=u("table-body"),i=u("data-table");return m(),x("div",null,[d(i,{rows:e.tableData,pagination:e.pagination,sort:e.sort,striped:"",onLoadData:e.loadData},{thead:r(()=>[d(a,{sortable:"login",onSorting:e.loadData},{default:r(()=>[b("Логин")]),_:1},8,["onSorting"]),d(a,{sortable:"email",onSorting:e.loadData},{default:r(()=>[b("Email")]),_:1},8,["onSorting"]),e.role?C("",!0):(m(),h(a,{key:0,sortable:"role",onSorting:e.loadData},{default:r(()=>[b("Роль")]),_:1},8,["onSorting"])),e.role=="admin"?(m(),h(a,{key:1},{default:r(()=>[d(s,{to:{name:"dashboard.users.admins.reg"},tag:"button",type:"button",class:"btn btn-success"},{default:r(()=>[b("Добавить")]),_:1})]),_:1})):C("",!0)]),tbody:r(({row:n})=>[d(o,{textContent:D(n.login)},null,8,["textContent"]),d(o,{textContent:D(n.email)},null,8,["textContent"]),e.role?C("",!0):(m(),h(o,{key:0,textContent:D(n.role)},null,8,["textContent"]))]),empty:r(()=>[H]),_:1},8,["rows","pagination","sort","onLoadData"])])}const U=T(I,[["render",J]]);export{U as default};
