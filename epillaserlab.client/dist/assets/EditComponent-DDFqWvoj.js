import{d as l,a as d,u as p,b as f,_ as h,g as b,o as y,c as w,e as n,w as C,v as N,h as D,p as _,m as T,y as v}from"./index-DnMKBQom.js";const g=l({async beforeCreate(){const e=await(await fetch(`/api/${this.refName}/${this.idRec}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})).json();this.data.name=e.rec.name,this.oldDataName.name=e.rec.name},setup(){let t=d({name:""});const e=p(),r=e.currentRoute.value.params.referencename,i=e.currentRoute.value.params.id,s=f(),a=d({name:""});return{data:a,submitForm:async u=>{if(a.name=="")return s.info("Введите значение");if(t.name==a.name)return s.info("Введите новое значение");await fetch(`/api/${r}/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}).then(async m=>{const o=await m.json();o.message=="OK"?(s.success("Запись успешно изменена"),e.push({name:"dashboard.reference",params:{referencename:r}})):o.message=="DUPLICATION"?s.error("Дублирование записи"):o.message=="NOT CHANGED"?s.info("Внесите изменения"):o.message=="DATA NOT VALID"||o.status==400?s.error("Введите значения"):s.error("Ошибка при изменении записи")}).catch(m=>e.push({name:"dashboard"}))},refName:r,idRec:i,oldDataName:t}}}),$={class:"form-group row"},A=n("label",null,"Изменить запись",-1),E={class:"row mt-3"},F=n("button",{type:"submit",class:"btn btn-success me-3",style:{width:"120px"}},"Сохранить",-1);function O(t,e,r,i,s,a){const c=b("router-link");return y(),w("form",{class:"row col-3",onSubmit:e[1]||(e[1]=T((...u)=>t.submitForm&&t.submitForm(...u),["prevent"]))},[n("div",$,[A,C(n("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=u=>t.data.name=u),class:"col-3 form-control mt-3",placeholder:"Введите значение"},null,512),[[N,t.data.name]])]),n("div",E,[F,D(c,{tag:"button",to:{name:"dashboard.reference",params:{referencename:t.refName}},type:"submit",class:"btn btn-secondary",style:{width:"120px"}},{default:_(()=>[v("Назад")]),_:1},8,["to"])])],32)}const V=h(g,[["render",O]]);export{V as default};
